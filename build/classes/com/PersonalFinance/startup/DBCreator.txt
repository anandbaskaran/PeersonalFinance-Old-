CREATE TABLE USERS(
   USER_ID  SERIAL PRIMARY KEY,
   NAME           TEXT    NOT NULL,
   EMAIL          TEXT    NOT NULL,
   PASS           TEXT    NOT NULL,
   INCOME		  REAL,
   MONTHLY_SAVINGS REAL,
   DATE_OF_BIRTH  DATE,			
   NET_WORTH	  REAL    DEFAULT 0,
   TOTAL_INVESTMENTS REAL DEFAULT 0,
   TOTAL_GAIN REAL DEFAULT 0,
   GAIN_PERCENTAGE REAL DEFAULT 0,
   TODAY_GAIN REAL DEFAULT 0,
   TODAY_GAIN_PERCENTAGE REAL DEFAULT 0,
   TOTAL_RISK REAL DEFAULT 0,
   CONSTRAINT uniqueUserEmail UNIQUE(EMAIL)
);

CREATE TABLE objective(
   USER_ID    INT   NOT NULL references USERS(USER_ID),
   OBJECTIVE      TEXT NOT NULL,
   OBJECTIVE_COST  REAL NOT NULL,
   OBJECTIVE_DATE DATE
);

CREATE TABLE INDICES(
   NAME   TEXT    NOT NULL PRIMARY KEY
);

CREATE TABLE MF(
   PRODUCTCODE  TEXT PRIMARY KEY,
   COMPANY_NAME TEXT NOT NULL,
   MF_NAME   TEXT    NOT NULL,
   TAX    REAL,
   NO_TAX_PERIOD REAL,
   BENCHMARK_INDEX TEXT references INDICES(NAME),
   RISK REAL,
   CRSIL_RANK REAL
);

CREATE TABLE PORTFOLIO_MF(
   USERID    INT    NOT NULL references USERS(USER_ID),
   PRODUCTCODE    TEXT  NOT NULL references MF(PRODUCTCODE),
   FOLIO_NUMBER TEXT,   
   TOTAL_UNITS        REAL NOT NULL,
   AVERAGE_PRICE       REAL NOT NULL
);

CREATE TABLE PORTFOLIO_STOCKS(
   USERID    INT    NOT NULL references USERS(USER_ID),
    "Symbol" text	NOT NULL PRIMARY KEY,
    "ISIN" text	NOT NULL,
    "Quantity" numeric(1000, 2),
    "BuyAvg" numeric(1000, 2),
    "BuyValue" numeric(1000, 2),
    "PreviousClossingPrice" numeric(1000, 2),
    "PresentValue" numeric(1000, 2),
    "Profit" numeric(1000, 2),
    "ProfitPercentage" numeric(1000, 2)
);


CREATE TABLE TRANSACTIONS_MF(
   USERID    INT    NOT NULL references USERS(USER_ID),
   PRODUCTCODE    TEXT  NOT NULL references MF(PRODUCTCODE),
   TRADE_DATE 	DATE,
   DIVIDEND_RATE REAL,
   UNITS        REAL NOT NULL,
   AMOUNT       REAL NOT NULL,
   PRICE       REAL NOT NULL,
   DESCRIPTION TEXT
);

CREATE TABLE PORTFOLIO_BANK(
   USER_ID INT NOT NULL references USERS(USER_ID),
   ID SERIAL PRIMARY KEY,
   ACCOUNT_NUMBER BIGINT,
   TYPE CHARACTER(4),
   INTEREST_RATE REAL NOT NULL ,
   START_DATE DATE,
   END_DATE         DATE,
   AMOUNT      REAL NOT NULL,
   MATURITY_AMOUNT REAL NOT NULL,
   BANK_NAME TEXT,
   CONSTRAINT uniqueAccountNumber UNIQUE(ACCOUNT_NUMBER)
);

Create Table TRANSACTIONS_BANK(
	BANK_ID INT NOT NULL references PORTFOLIO_BANK(ID),
	AMOUNT       REAL NOT NULL,
	DESCRIPTION TEXT,
	MF TEXT  references MF(PRODUCTCODE),
	STOCK TEXT	
);
INSERT INTO USERS (NAME, EMAIL, PASS) VALUES ('Anand Bhaskaran', 'anand@pf.in', 'pf');